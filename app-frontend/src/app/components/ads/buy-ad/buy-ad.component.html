<app-navbar></app-navbar>

<div class="container mt-6">
  <div class="box">
    <h2 class="title is-3 has-text-centered">Crear Anuncio</h2>
    <div class="m-4">
      <div class="columns">
        <div class="column is-flex-direction-column is-justify-content-center">
          <form [formGroup]="adForm">
            <div class="field">
              <label class="label">Tipo de Anuncio</label>
              <div class="control">
                <div class="select">
                  <select formControlName="adType">
                    @for (type of adTypesList ; track type.id) {
                      <option [value]="type.id">{{type.name}}</option>
                    }
                  </select>
                </div>
              </div>
            </div>
            @if(currentType === "TEXT" || currentType === "VIDEO") {
              <div class="field">
                <label class="label">Contenido</label>
                <div class="control">
                  <input formControlName="content" class="input" type="text" placeholder="contenido o url del video">
                </div>
              </div>
            } @else {
              <div class="my-5">
                <label class="label">Archivo</label>
                <div class="file">
                  <label class="file-label">
                    <input class="file-input" type="file"
                           accept=".jpg, .jpeg, .png"
                           (change)="onFileSelected($event)"
                           name="resume" />
                    <span class="file-cta">
                      <span class="file-label">{{ this.filename || "Elige un archivo" }}</span>
                    </span>
                  </label>
                </div>
              </div>
            }
            <div class="field">
              <label class="label">Periodo</label>
              <div class="control">
                <div class="select">
                  <select formControlName="period">
                    @for (period of periodsList ; track period.id) {
                      <option [value]="period.id">{{period.name}}</option>
                    }
                  </select>
                </div>
              </div>
            </div>
            <div class="field">
              <label class="label">Categoría</label>
              <div class="control">
                <div class="select">
                  <select formControlName="category">
                    @for (category of categoriesList ; track category.id) {
                      <option [value]="category.id">{{category.name}}</option>
                    }
                  </select>
                </div>
              </div>
            </div>
            <div class="field">
              <label class="label">Rango de fechas</label>
              <div class="control">
                <mat-form-field appearance="outline" >
                  <mat-date-range-input [rangePicker]="picker">
                    <input formControlName="start" matStartDate placeholder="Inicio">
                    <input formControlName="end" matEndDate placeholder="Fin">
                  </mat-date-range-input>
                  <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
                  <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                  <mat-date-range-picker #picker></mat-date-range-picker>
                </mat-form-field>
              </div>
            </div>
            <div class="grid">
              <div class="cell">
                <button class="button is-link" type="button" (click)="showPreview()">Previsualizar</button>
              </div>
              <div class="cell">
                <button class="button is-primary" [disabled]="adForm.invalid" (click)="save()">Guardar</button>
              </div>
            </div>
          </form>
        </div>
        <div class="column">
          <h4 class="subtitle is-4 has-text-centered">Previsualización</h4>
          @if(this.showTemplate) {
            <div class="m-5">
              <app-ad-template [showButton]="true" [data]="this.adForm.get('content')?.value" [type]="this.currentType"></app-ad-template>
            </div>
          } @else {
            <h3>Nada para mostrar aún</h3>
          }
        </div>
      </div>
    </div>
  </div>
</div>

